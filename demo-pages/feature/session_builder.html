<!DOCTYPE html>
<html lang="en">
<link rel="shortcut icon" type="image/x-icon" href="https://demo.surfly.com/resources-common/icons/Favicon-PNG.png">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://demo.surfly.com/css-common/surfly-javascript-style.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-javascript.min.js"></script>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surfly Session Builder</title>
    <style>
        :root {
            --light-red: #e54747;
            --dark-red: #c72323;
            --light-blue: #7cadbf;
            --blue: #2288ad;
            --dark-blue: #166e8e;
            --yellow: #f4c344;
            --orange: #fd942a;
            --light-green: #7dc05a;
            --dark-green: #48a418;
            --darkest-grey: #4d4d4d;
            --dark-grey: #757575;
            --grey: #b2b2b2;
            --light-grey: #d8dada;
            --lightest-gray: #eff0f0;
            --off-white: #f9f9f9;
            --white: #ffffff;
            --background: #2f2f2f;
            --font: 'Nunito', sans-serif;
        }

        body {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: flex-start;
            background-color: var(--white);
            font-family: var(--font);
            overflow: hidden;
            margin-bottom: 0;
            margin: 0;
        }

        pre {
            margin: 0;
        }

        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 60%;
            height: 97vh;
            padding: 20px;
            padding-bottom: 0px;
            overflow: scroll;
            transition: width 0.5s ease;
            -ms-overflow-style: none;
            scrollbar-width: none;
        }

        .content-body {
            display: flex;
            flex-direction: column;
            height: 100%;
            margin-top: 10%;
            padding: 5px;
        }

        .hide-show-js-div {
            position: sticky;
            display: flex;
            height: 24px;
            top: -2px;
            right: 0;
            align-self: flex-end;
            align-content: center;
            transform: translateX(20px);
            background-color: var(--lightest-gray);
            border-radius: 12px 0px 0px 12px;
            padding: 5px;
            transition: transform 0.5s linear;
        }

        .hide-show-js-div>#expand-collapse-arrow {
            float: right;
            clear: both;
            transition: transform 0.5s linear;
        }

        .javascript-window {
            font-size: .7em;
            width: 40%;
            overflow: scroll;
            height: 100vh;
            background-color: var(--background);
            user-select: text !important;
            transition: width 0.5s ease;
            z-index: 1;
        }

        .javascript-window ::selection {
            background: var(--dark-red) !important;
            color: var(--white) !important;
        }

        .javascript-window ::-moz-selection {
            background: var(--dark-red) !important;
            color: var(--white) !important;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 15% auto;
            padding: 20px;
            width: fit-content;
            text-align: center;
            background-color: var(--light-blue);
            border-radius: 8px;
            border: 2px solid var(--light-grey);
        }

        .modal-buttons {
            display: flex;
            flex-direction: row;
        }

        .modal button {
            margin: 5px;
        }

        .submit-button {
            background-color: var(--dark-red);
            box-sizing: border-box;
            border-radius: 50px;
            color: var(--white);
            cursor: pointer;
            font-family: var(--font);
            font-size: 1rem;
            font-weight: 100;
            padding: .5rem 1rem;
            border: 0;
            touch-action: manipulation;
            white-space: nowrap;
            width: 60%;
        }

        .input-field {
            width: 90%;
            padding: 10px;
            font-size: 1.2rem;
            border: 2px solid var(--blue);
            border-radius: 50px;
            margin-bottom: 20px;
            outline: none;
        }

        .input-field#metadata_input_value,
        .input-field#metadata_input_key {
            width: 230px;
        }

        .input-field:focus {
            border-color: var(--dark-blue);
            color: var(--dark-grey);
        }

        .input-field::placeholder {
            color: var(--light-blue);
            opacity: 50%;
        }

        .surfly-logo {
            width: 10%;
        }

        h2 {
            color: var(--darkest-grey);
            font-size: 2em;
        }

        li {
            color: var(--dark-grey);
            font-size: 1.5em;
        }

        p {
            color: var(--white);
            font-size: 1.2em;
        }

        .button-description {
            color: var(--lightest-gray);
            font-size: .8em;
            margin: 0;
            padding: 0;
        }

        button {
            background-color: var(--dark-red);
            box-sizing: border-box;
            border-radius: 50px;
            color: var(--lightest-gray);
            cursor: pointer;
            font-family: var(--font);
            font-size: 1em;
            font-weight: 100;
            padding: .2rem .8rem;
            border: 0;
            touch-action: manipulation;
            white-space: nowrap;
            height: auto;
            margin-right: 2px;
        }

        #hide-show-button {
            all: unset;
            touch-action: manipulation;
            cursor: pointer;
        }

        .container {
            width: 100%;
            height: 100%;
            padding-left: 20px;
            padding-right: 20px;
            display: flex;
            flex-direction: column;
        }

        img.selected {
            outline: 4px solid var(--dark-grey);
            box-sizing: border-box;
            border-radius: 50%;
        }

        @keyframes gentle-flash {
            0% {
                opacity: 1;

            }

            50% {
                opacity: 0.5;
            }

            100% {
                opacity: 1;
            }
        }

        .warning-message-hidden {
            display: none;
        }

        .warning-message {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            z-index: 999;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .warning-message-text {
            color: var(--white);
            background-color: var(--orange);
            padding: 5px;
            margin: 0;
            font-weight: normal;
            font-size: 1em;
            animation: gentle-flash 2.5s infinite ease-in-out;
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .category-content {
            display: none;
            max-width: 900px;
        }

        .category-description {
            color: var(--dark-grey);
            font-size: .9em;
            padding: 0;
            margin: 5px;
            margin-left: 0;
        }

        .category-description#metadata-description,
        .category-description#tags-description {
            margin-bottom: 0;
            margin-top: 10px;
        }

        .category-description#full-screen-label,
        .category-description#preview-screen-label {
            margin: 0px;
            margin-bottom: 3px;
            color: var(--grey);
            font-size: .8em;
        }

        #additional-tab-preview-query-paramaters {
            margin-top: 10px;
            font-size: .8em;
            max-width: 90%;
            width: max-content;
            overflow-wrap: break-word;
            word-wrap: break-word;
            word-break: break-all;
            white-space: normal;
        }

        .roles {
            width: 20%;
            display: flex;
            flex-direction: column;
            overflow-y: auto;
            margin-right: 20px;
        }

        .settings {
            width: 100%;
            display: flex;
            flex-direction: column;
        }

        .settings .category,
        .roles .category {
            background-color: var(--white);
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .roles h2 {
            margin-top: 0;
            margin-bottom: 0;
            font-size: 1em;
            font-weight: normal;
            color: var(--dark-red);
        }

        .category .category-items {
            display: flex;
            justify-content: space-around;
            align-items: center;
            margin: 10px;
        }

        .category-items img {
            width: 50px;
            height: 50px;
        }

        .category-heading {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: var(--dark-grey);
            font-size: 1em;
            margin-bottom: 5px;
        }

        .feature-toggles {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-gap: 20px 0px;
            padding-bottom: 20px;
            padding-top: 10px;
            margin-bottom: 20px;
            background-color: var(--off-white);
            border-radius: 20px;
        }

        .drop-down {
            background-color: var(--light-green);
            border-radius: 20px;
            color: var(--lightest-gray);
            border: 1px solid var(--light-grey);
            cursor: pointer;
            font-family: var(--font);
            font-size: .9rem;
            padding: .1rem .5rem;
            touch-action: manipulation;
            text-align: center;
            margin-top: 0px;
            margin-bottom: 4px;
            width: 100px;
        }

        .drop-down:focus {
            outline: none;
        }

        .view-select {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .settings-toggle,
        .single-toggle {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .single-toggle#queue-toggle {
            width: max-content;
        }

        .settings-toggle h2,
        .single-toggle h2 {
            font-size: .8em;
            font-weight: lighter;
            font-family: 'Courier New', Courier, monospace;
            margin-bottom: 0;
            text-transform: lowercase;
            margin-top: 8px;
            color: var(--dark-grey);
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 24px;
            margin-bottom: 4px;
            margin-top: 8px;
        }

        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--lightest-gray);
            border: 1px solid var(--light-grey);
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 12px;
            width: 12px;
            left: 4px;
            bottom: 4px;
            background-color: var(--dark-red);
            transition: .4s;
            border-radius: 50%;
            border: 1px solid var(--grey);
        }

        input:checked+.slider {
            background-color: var(--white);
            border: 1px solid var(--light-grey);
        }

        input:checked+.slider:before {
            transform: translateX(16px);
            background-color: var(--dark-green);
            border: 1px solid var(--light-green);
        }

        .your-settings {
            font-size: .7em;
            width: 35%;
            background-color: var(--dark-grey);
            color: var(--text-color);
            padding: 1px;
            border-radius: 10px;
            overflow: auto;
            height: fit-content;
        }

        .section-heading {
            font-style: normal;
            font-size: 1.2em;
            color: var(--darkest-grey);
            text-align: left;
            margin-bottom: 2px;
            margin-top: 1px;
        }

        .input-preview {
            max-width: 90%;
            width: max-content;
            overflow-wrap: break-word;
            word-wrap: break-word;
            word-break: break-all;
            white-space: normal;
            display: flex;
            font-size: .8em;
            font-family: 'Courier New', Courier, monospace;
            margin-bottom: 0;
            text-transform: lowercase;
            background-color: var(--lightest-gray);
            color: var(--grey);
            border-radius: 10px;
            padding: 5px;
            margin-top: 5px;
        }

        .required-configs-div {
            display: flex;
            flex-direction: column;
            background-color: var(--lightest-gray);
            font-family: 'Courier New', Courier, monospace;
            margin-bottom: 50px;
            margin-left: 5px;
            width: max-content;
            height: fit-content;
            color: var(--dark-grey);
            font-weight: lighter;
            font-size: 1em;
            border-radius: 10px;
            padding-top: 5px;
            padding-bottom: 5px;
            padding: 15px;
        }

        .config-category {
            color: var(--dark-blue);
            background-color: var(--lightest-gray);
            border-radius: 10px;
            padding: 5px;
            font-weight: light;
        }

        span#config-requirements-heading {
            font-size: .8em;
            text-align: center;
            display: none;
            margin-bottom: 10px;
            width: 100%;
            margin-top: 0px;
            background-color: var(--lightest-gray);
            color: var(--grey);
            border-radius: 8px;
            padding: 3px;
        }

        .hide-input-preview {
            opacity: 0;
            display: none;
        }

        .button-container {
            width: 100%;
            display: flex;
            justify-content: flex-start;
            align-items: center;
            margin-top: 2px;
            margin-bottom: 20px;
        }

        .copy-buttons {
            display: flex;
            flex-direction: column;
            align-content: space-between;
        }

        .or {
            display: inline-block;
            height: 60%;
            width: 2px;
            margin: 0 10px;
            font-size: 18px;
            background-color: var(--lightest-gray);
            text-align: center;
        }

        .start-session {
            background-color: var(--white);
            border: 1px solid var(--dark-red);
            box-sizing: border-box;
            border-radius: 50px;
            color: var(--light-red);
            cursor: pointer;
            font-family: var(--font);
            font-size: 1rem;
            font-weight: 150;
            padding: .4rem .6rem;
            touch-action: manipulation;
            margin: 40px 10px;
            white-space: nowrap;
            width: 250px;
        }

        .input-selector-div {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;
            width: 100%;
        }

        .input-string-div {
            display: flex;
            flex-direction: row;
            justify-content: flex-start;
            align-items: baseline;
        }

        .input-string-div input {
            background-color: var(--white);
            border: 1px solid var(--light-grey);
            border-radius: 12px;
            color: var(--dark-grey);
            font-size: 1em;
            font-weight: 300;
            padding: .5em 1em;
            text-align: center;
            margin-right: .2vw;
            margin-top: 1vh;
            width: 500px;
        }

        .input-field {
            outline: none;
        }

        .input-field:focus {
            background-color: var(--white);
            border: 1px solid var(--dark-red);
        }

        .category-content {
            display: none;
            overflow: scroll;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
            color: var(--darkest-grey);
            padding: 5px;
        }

        .checkbox-option input[type="checkbox"] {
            margin-right: 8px;
            display: none;
        }

        .custom-checkbox {
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background-color: var(--lightest-grey);
            border: 2px solid var(--light-grey);
            margin-right: 8px;
            cursor: pointer;
        }

        .checkbox-option input[type="checkbox"]:checked+.custom-checkbox {
            background-color: var(--dark-red);
            border: 2px solid var(--lightest-gray);
        }

        .toggle-button {
            background-color: var(--white);
            color: var(--dark-red);
            border: none;
            padding: 0px;
            cursor: pointer;
            border-radius: 5px;
            margin-bottom: 1px;
        }

        .disclaimer {
            display: flex;
            flex-direction: column;
            padding: 10px 20px;
            margin-top: 30px;
            border-radius: 12px;
            max-width: 900px;
            background-color: var(--off-white);
            align-self: flex-start;
        }

        .disclaimer-title {
            color: var(--grey);
            font-size: .9rem;
            margin-bottom: 10px;
        }

        .disclaimer-text {
            color: var(--grey);
            font-size: .8rem;
            text-align: justify;
            text-justify: inter-word;
        }


        @media (max-width: 800px) {
            .javascript-window {
                display: none;
            }

            .content {
                width: 100%;
            }

            .hide-show-js-div {
                display: none;
            }
        }
    </style>


    <script>
        //to do
        //make sure pin modal doesn't show if queue is skipped 
        //hide rest of page if not widget key has been found
        //test test test
        //remove any redundant widget key code
        //fix removeImportedSurflySetttings() - calling it at the start of the import function removed the newly added key and then init fails. Need to remove settings at the start of that function WITHOUT removing the widget key
        //emptySettings var isnt staying empty
        //fix the widget key placement
        //add the remaining category show/hide logic
        //find out what's up with emptySettings
        //try and make the script preview updat with the toggles when resetting the widget key
        //reorder and clean up


    </script>
    <script id="myScript">
        //1// INITIAL SCRIPT
        //Starting script to be edited by updateScriptElement(). 
        //Settings listed here because to process used to update them visually requires it
        var settings = {
            admission_enabled: '',
            alternative_proxy_enabled: '',
            anonymous_users_can_share_camera: '',
            anyone_can_deactivate_space: '',
            block_until_agent_joins: '',
            chat_enabled: '',
            cookie_transfer_enabled: '',
            default_invitations_enabled: '',
            document_editor_enabled: '',
            download_trigger_enabled: '',
            enable_cookie_backtransfer: '',
            end_redirect_enabled: '',
            filesharing_enabled: '',
            format_session_id: '',
            headless: '',
            hide_cursors: '',
            hide_session_ui: '',
            host_switching_allowed: '',
            invitations_allowed: '',
            multileader: '',
            native_selects: '',
            new_urls_allowed: '',
            non_hosts_can_open_tabs: '',
            notifications_enabled: '',
            original_file_download_allowed: '',
            p2p_videochat_enabled: '',
            participants_can_request_to_interact: '',
            pause_enabled: '',
            private_session: '',
            screensharing_enabled: '',
            session_autorestore_enabled: '',
            session_start_confirmation: '',
            sounds_enabled: '',
            start_muted: '',
            start_with_chat_open: '',
            start_with_fullscreen_videochat: '',
            start_with_invite_modal: '',
            start_with_loading_screen: '',
            start_with_videochat_on: '',
            url_mangling: '',
            videochat_enabled: '',
            videochat_prompt: '',
            default_videochat_fullscreen_mode: '',
            default_videochat_mode: '',
        };
    </script>
    <script>
        //2// DEPENDENCIES
        //Functions to manage and implement dependencies 
        // Function to load Prism scripts (formats the JS preview)
        function loadScripts() {
            const prismScript1 = document.createElement('script');
            prismScript1.src = "https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js";
            prismScript1.onload = function () {
                const prismScript2 = document.createElement('script');
                prismScript2.src = "https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-javascript.min.js";
                document.body.appendChild(prismScript2);
            };
            document.body.appendChild(prismScript1);
        }
        // Initialize script loading and content update
        document.addEventListener("DOMContentLoaded", function () {
            // Initial update
            updateCodePreview();
            loadScripts();

            // Create a MutationObserver to watch for changes in myScript element
            const observer = new MutationObserver(updateCodePreview);
            const myScriptElement = document.getElementById("myScript");
            // Observing the myScript element for changes in its content
            if (myScriptElement) {
                observer.observe(myScriptElement, {
                    childList: true,
                    subtree: true,
                    characterData: true
                });
            }
        });
    </script>
    <script>
        //3// VARS
        //Vars needed in this page and explanations below each
        var scriptElement;
        //Holds the script to be displayed on the page
        var allSettings = '';
        //collects all settings together in one var
        var emptySettings = '';
        //to reset when needed
        var sessionStarted = '';
        //code block for this event
        var sessionLoaded = '';
        //code block for this event
        var userAcvivity = '';
        //code block for this event
        var participantJoined = '';
        //code block for this event
        var selectedRegions = [];
        //stores the Surfly server regions 
        var startUrl = '';
        //Stores the start URL for the session
        var widgetKey = '';
        //Stores the widget key for the session
        var maskingString = '';
        //Stores the masking selector string for the session
        var tagsArray = '';
        //Stores the tags array
        var indentedTagsArray;
        //indented tags array for display
        var metadataObject = {};
        //stores the metadata object
        var AdditionalUrls;
        //stores a string of additional urls for additional tabs
        var AdditionalUrlQueryParams = '';
        //stores the additional tab urls in query paramater format for session links
        var AdditionalUrlNewTabs;
        //adds the additional urls to Surfly open tab function
        var skipQueue = '';
        //stores the skip queue value
        var controlAndHostToAgent = '';
        //adds event triggered code to transfer host and control to an agent when they join
        var instantScreenShare = '';
        //adds event triggered code to auto start screenshare
        var startFullScreenVideo = '';
        //adds event triggered code to trnsition to full screen video when someone joins
        var endIfNoAgent = '';
        //adds event triggered code to end a session if no agent joins
        var endIfNoActivity10Mins = '';
        //adds event triggered code to end session after inactivity
        var formattedMetadataJSON;
        //holds metadata object converted to string
        var indentedFormattedMetadataJSON;
        //holds html formatted string to look like object again
        var eventConfigRequirements = '';
        //holds the required session configs for selections made for display on page
        var firstTabUrlSubmitted = false;
        //used to check if a new tab entry has already been submitted
    </script>
    <script>
        //4// VISUAL UPDATES FOR THE PAGE
        //function to update the code snippet based on user selections
        //function also updates previews on selections outside the code snippet
        //This function is called by many other functions to maintain updated display of selections in the on screen snippet
        // Function to update the settings element in the script tag and flash the updated line

        //filter out the values from the initial settings block that do not have a value (messy but im locked in)
        function filterValidValues(obj) {
            return Object.keys(obj)
                .filter(key => !!obj[key]) // Filters out any falsy values
                .reduce((acc, key) => {
                    acc[key] = obj[key];
                    return acc;
                }, {});
        }

        function updateScriptElement() {
            scriptElement = document.getElementById("myScript");
            const filteredSettings = filterValidValues(settings);
            const settingsString = JSON.stringify(filteredSettings, null, 4);
            const widgetKetPreivew = document.getElementById("widget-key-preview");
            const startUrlPreivew = document.getElementById("start-url-preview");
            const maskingPreivew = document.getElementById("masking-preview");
            const additionalTabsPreivew = document.getElementById("additional-tab-preview");
            const additionalTabPreviewQueryParamaters = document.getElementById("additional-tab-preview-query-paramaters");
            const tagsPreview = document.getElementById("tags-preview");
            const metadataPreview = document.getElementById("metadata-preview");
            const eventRequirementsHeading = document.getElementById("required-configs");
            const eventRequirementsPreview = document.getElementById("event-config-requirements-preview");
            const importSettingsContent = settingsString.slice(1, settingsString.length - 2);
            const settingsContent = importSettingsContent
                ? importSettingsContent.trim().endsWith(',')
                    ? importSettingsContent.trim()
                    : importSettingsContent.trim() + ","
                : '';
            const formattedRegions = selectedRegions && selectedRegions.length > 0 ? `[\t${selectedRegions.map(region => `\n\t\t"${region}"`).join(',')}\n\t\t\t]`
                : '';
            //update widget key preview
            if (widgetKey) {
                widgetKetPreivew.textContent = widgetKey;
                widgetKetPreivew.classList.remove('hide-input-preview');
            } else {
                widgetKetPreivew.classList.add('hide-input-preview');
            }

            //update start url preview
            if (startUrl) {
                startUrlPreivew.textContent = startUrl;
                startUrlPreivew.classList.remove('hide-input-preview');
            } else {
                startUrlPreivew.classList.add('hide-input-preview');
            }

            //update masking preview
            if (maskingString) {
                maskingPreivew.textContent = maskingString;
                maskingPreivew.classList.remove('hide-input-preview');
            } else {
                maskingPreivew.classList.add('hide-input-preview');
            }
            //update additional tab previews
            if (AdditionalUrls) {
                additionalTabsPreivew.textContent = AdditionalUrls;
                additionalTabPreviewQueryParamaters.innerHTML = "Open tabs for someone else by adding the following to their join link: " + "<b>" + AdditionalUrlQueryParams + "</b>";
                additionalTabsPreivew.classList.remove('hide-input-preview');
                additionalTabPreviewQueryParamaters.classList.remove('hide-input-preview');
            } else {
                additionalTabsPreivew.classList.add('hide-input-preview');
                additionalTabPreviewQueryParamaters.classList.add('hide-input-preview');
            }
            //update tags preview
            if (tagsArray.length > 0) {
                tagsPreview.classList.remove('hide-input-preview');
                tagsPreview.innerHTML = JSON.stringify(tagsArray, null, 2);
            } else {
                tagsPreview.classList.add('hide-input-preview');
                tagsPreview.innerHTML = '';
                tagsArray = [];
            }
            //update metadata preview
            if (formattedMetadataJSON) {
                metadataPreview.classList.remove('hide-input-preview');
                metadataPreview.innerHTML = "<pre>" + formattedMetadataJSON + "</pre>";
            } else {
                metadataPreview.innerHTML = '';
                metadataPreview.classList.add('hide-input-preview');
            }
            //update event config requirements preview
            if (eventConfigRequirements) {
                eventRequirementsHeading.classList.remove('hide-input-preview');
                eventRequirementsPreview.classList.remove('hide-input-preview');
                eventRequirementsPreview.innerHTML = "<pre>" + eventConfigRequirements + "</pre>";
            } else {
                eventConfigRequirements = '';
                eventRequirementsPreview.classList.add('hide-input-preview');
                eventRequirementsHeading.classList.add('hide-input-preview');
            }

            //manage the custom settings variable
            allSettings =
                // `${widgetKey ? '\n\t"widget_key": ' + `"${widgetKey}",` : ''}` +
                `${startUrl ? '\n\t' + '"url": ' + '"' + `${startUrl}` + '"' + `,` : ''}` +
                `${skipQueue ? `\n\t${skipQueue},` : ''}` +
                `${formattedRegions ? '\n\t"selected_regions": ' + `${formattedRegions},` : ''}` +
                `${settingsContent ? '\n\t' + `${settingsContent}` : ''}` +
                `${maskingString ? '\n\t"hide_element_by_selector": ' + `"${maskingString}",` : ''}` +
                `${indentedTagsArray ? '\n\t"tags": ' + `${indentedTagsArray}` : '\n\t"tags": [' + '\n\t\t"Session-Builder"' + '\n\t\t\t]'}`;

            //manage session_started event block
            if (endIfNoAgent) {
                sessionStarted = `
            .on("session_started", function (session, event) {
                console.log("Session has started");${endIfNoAgent ? `\n\t\t\t\t${endIfNoAgent}` : ''}
            })`;
            } else {
                sessionStarted = '';
            }
            //manage session_loaded event block
            if (endIfNoActivity10Mins) {
                userAcvivity = `
            .on("user_activity", function (session, event) {${endIfNoActivity10Mins}
            })`;
            } else {
                userAcvivity = '';
            }
            //manage session_loaded event block
            if (instantScreenShare || AdditionalUrlNewTabs) {
                sessionLoaded = `
            .on('session_loaded', function (session, event) {
                console.log("Session loaded successfully");${AdditionalUrlNewTabs ? `\n\t\t\t\t${AdditionalUrlNewTabs}` : ''}${instantScreenShare ? `\n\t\t\t\t${instantScreenShare}` : ''} 
            })`;
            } else {
                sessionLoaded = '';
            }
            //manage user_acvivity event block
            if (endIfNoActivity10Mins) {
                userAcvivity = `
            .on("user_activity", function (session, event) {${endIfNoActivity10Mins}
            })`;
            } else {
                userAcvivity = '';
            }
            //manage participant_joined event block
            if (startFullScreenVideo || controlAndHostToAgent || endIfNoAgent) {
                participantJoined = `
            .on('participant_joined', function (session, event) {
                console.log('Participant ', event.clientIndex, 'joined the session');${startFullScreenVideo ? `\n\t\t\t\t${startFullScreenVideo}` : ''}${controlAndHostToAgent ? `\n\t\t\t\t${controlAndHostToAgent}` : ''}${endIfNoAgent ? `\n\t\t\t\tparticipantJoined = true;` : ''}
            })`
            } else {
                participantJoined = '';
            }

            //update the page code snippet
            scriptElement.textContent = `
    
    (function (s, u, r, f, l, y) {
    s[f] = s[f] || { init: function () { s[f].q = arguments } };
    l = u.createElement(r); y = u.getElementsByTagName(r)[0]; l.async = 1;
    l.src = 'https://surfly.com/surfly.js'; y.parentNode.insertBefore(l, y);
    }) (window, document, 'script', 'Surfly');
    
    var SurflySession;${endIfNoAgent ? `\n\tvar participantJoined = false;` : ''}
    var settings = {${allSettings ? `${allSettings}\n\t\t};` : '};'}
    
    Surfly.init(settings, function (init) {
        if (init.success && !Surfly.isInsideSession) {
            console.log("init success");
            SurflySession = Surfly.session().create()
            .on("session_created", function (session, event) {
                SurflySession.startLeader(${indentedFormattedMetadataJSON ? "null," + `\n${indentedFormattedMetadataJSON}` : ''});
            })${sessionStarted}${sessionLoaded}${userAcvivity}${participantJoined} 
        }
    });
    `;
        }

        // Also adjust the position immediately after toggling the preview
        function toggleJavascriptPreview() {
            const javascriptViewer = document.getElementById('javascript-viewer');
            const sessionBuilderUI = document.getElementById('session-builder-ui');
            const toggleJavaScriptButton = document.getElementById("hide-show-button");

            // Check current widths and toggle between the two states
            if (javascriptViewer.style.width === '0%' && sessionBuilderUI.style.width === '100%') {
                // Revert to initial state
                javascriptViewer.style.width = '40%';
                sessionBuilderUI.style.width = '60%';
                toggleJavaScriptButton.style.transform = "none";
            } else {
                // Set to hidden state
                javascriptViewer.style.width = '0%';
                sessionBuilderUI.style.width = '100%';
                toggleJavaScriptButton.style.transform = "rotate(-180deg)";
            }
        }


    </script>
    <script>
        //5// BUILD THE CODE SNIPPET & MANAGE PAGE UX
        //Functions to manage the display and behaviour of the page

        //import settings from the given widgt key
        function importSurflySetttings() {
            delete Surfly;
            (function (s, u, r, f, l, y) {
                s[f] = s[f] || { init: function () { s[f].q = arguments } };
                l = u.createElement(r); y = u.getElementsByTagName(r)[0]; l.async = 1;
                l.src = 'https://surfly.com/surfly.js'; y.parentNode.insertBefore(l, y);
            })(window, document, 'script', 'Surfly');

            function updateSettingsWithDefaultValues(settings, defaultSettings) {
                for (var key in settings) {
                    if (defaultSettings.hasOwnProperty(key)) {
                        settings[key] = defaultSettings[key];
                        settings.widget_key = widgetKey;
                    }
                }
                updateScriptElement();
            }

            function updateSliders(settings) {
                for (var key in settings) {
                    if (settings.hasOwnProperty(key) && settings[key] !== null) {
                        var element = document.getElementById(key);

                        if (element) {
                            // Handle checkboxes
                            if (element.querySelector('input[type="checkbox"]')) {
                                element.querySelector('input[type="checkbox"]').checked = settings[key];
                            }
                            // Handle select elements
                            else if (element.tagName === 'SELECT') {
                                element.value = settings[key]; // Update the select element's value
                                toggleVideoView(element); // Call the function to update the video view (or other select element actions)
                            } else {
                                console.warn(`Element with ID ${key} is not a recognized input type.`);
                            }
                        } else {
                            console.warn(`Element with ID ${key} not found.`);
                        }
                    }
                }
            }

            function checkWidgetKey() {
                console.log("checking widget key");
                if (Surfly._initStatus.successful === true) {
                    console.log("Surfly initialized on page.");
                    if (Surfly._defaultSettings && Object.keys(Surfly._defaultSettings).length > 0) {
                        console.log("Surfly global settings found");
                        const trueValuesOnly = filterValidValues(Surfly._defaultSettings);
                        updateSettingsWithDefaultValues(settings, trueValuesOnly);
                        updateSliders(trueValuesOnly);
                        console.log("Surfly global settings imported into page");
                        delete Surfly;
                        updateAvailableOptions();
                        console.log("Aborting function");
                        return;
                    } else {
                        console.log("Widget Key Empty or init not called - try again");
                        alert("Please enter a valid Widget Key");
                        delete Surfly;
                        return;
                    }
                }
                if (Surfly._initStatus.successful === false || "null") {
                    console.log("Widget Key not recognised");
                    alert("Please enter a valid Widget Key");
                    delete Surfly;
                    return;
                }

                else {
                    console.log("Surfly initialization failed or was unsuccessful.");
                    alert("Something went wrong! Please try again");
                }
            }

            setTimeout(() => {
                if (typeof Surfly !== 'undefined' && Surfly._initStatus && Surfly._initStatus.started === false) {
                    console.log("attempting to initialize Surfly");
                    try {
                        Surfly.init(settings, function (initResult) {
                            if (typeof Surfly._initStatus === 'undefined') {
                                setTimeout(() => {
                                    console.log("Surfly._initStatus undefined, retrying after 0.5 seconds...");
                                    checkWidgetKey();
                                }, 500);
                            }
                            else checkWidgetKey();
                        });
                    }
                    finally {
                        //Try again if Surfly JS loads slowly
                        setTimeout(() => {
                            if (typeof Surfly !== 'undefined' && Surfly._initStatus && Surfly._initStatus.started === true) {
                                if (Surfly._initStatus.successful === true) {
                                    console.log("Settings import completed - second try aborted");
                                }
                                else {
                                    console.log("Try again...");
                                    checkWidgetKey();
                                }
                            }
                        }, 500);
                    }
                }
                else {
                    console.log("Something went wrong - Surfly did not initialize properly");
                }
            }, 500);
        }

        //remove settings from the given widget key
        function removeImportedSurflySetttings() {
            settings = emptySettings;
            var toggles = document.querySelectorAll('.settings-toggle input[type="checkbox"]');
            toggles.forEach(function (toggle) {
                toggle.checked = false;
            });
            console.log("widget key settings removed from snippet");
            updateScriptElement();
        }

        //Function to reveal the categories in Session Builder when they are expanded
        function toggleCategory(button) {
            var content = button.nextElementSibling;
            if (content.style.display === 'none') {
                content.style.display = 'block';
                button.textContent = 'Hide';
            } else {
                content.style.display = 'none';
                button.textContent = 'Expand';
            }
        }
        // Function to update code preview
        function updateCodePreview() {
            const scriptContent = document.getElementById("myScript").textContent;
            document.getElementById("code-preview").innerHTML = scriptContent;
            // Trigger Prism to highlight the code
            if (window.Prism) {
                Prism.highlightAll();
            }
        }
        //Function to update the code snippet event handlers & event handler related requirement text with code from relevant selection
        function updateEventVariables(eventName, isChecked) {
            let requirementsText = '';
            switch (eventName) {
                case 'controlAndHostToAgent':
                    controlAndHostToAgent = isChecked ? 'if (event.clientIndex !== 0) {' + '\n\t\t\t\t\t' +
                        'SurflySession.makeHost(1);' + '\n\t\t\t\t\t' +
                        'SurflySession.transferTabControl(1);}' + '\n\t\t\t\t' +
                        'else {' + '\n\t\t\t\t\t' +
                        'console.log(event.clientIndex + " joined the session - host not changed");' + '\n\t\t\t\t' + '};' : '';
                    requirementsText = "<span class=config-category>control and host switching:</span>" + "&nbsp;host_switching_allowed" + "," + "&nbsp;participants_can_request_to_interact";
                    break;
                case 'instantScreenShare':
                    instantScreenShare = isChecked ? 'SurflySession.startScreensharing();' : '';
                    requirementsText = "<span class=config-category>screen sharing:</span>" + "&nbsp;screensharing_enabled" + "," + "&nbsp;videochat";
                    break;
                case 'startFullScreenVideo':
                    startFullScreenVideo = isChecked ? 'SurflySession.toggleVideochatFullscreen();' : '';
                    requirementsText = "<span class=config-category>full screen video:</span>" + "&nbsp;videochat" + "," + "&nbsp;start_with_videochat_on";
                    break;
                case 'endIfNoAgent':
                    endIfNoAgent = isChecked ? '(async () => {' + '\n\t\t\t\t\t' +
                        'await new Promise(resolve => setTimeout(resolve, 120000));' + '\n\t\t\t\t\t' +
                        'if (participantJoined === true) {' + '\n\t\t\t\t\t\t' +
                        'console.log(\'Participant has joined.\');' + '\n\t\t\t\t\t' +
                        '} else {' + '\n\t\t\t\t\t\t' +
                        'SurflySession.end();' + '\n\t\t\t\t\t\t' +
                        'console.log("Session ended due no other participants joined within 2 minutes");' + '\n\t\t\t\t\t' +
                        '}' + '\n\t\t\t\t' + '})();' : '';
                    requirementsText = "";
                    break;
                case 'endIfNoActivity10Mins':
                    endIfNoActivity10Mins = isChecked ? '\n\t\t\t\t' +
                        'if (session.inactivityTimeout) {' + '\n\t\t\t\t\t' +
                        'clearTimeout(session.inactivityTimeout);' + '\n\t\t\t\t' +
                        '}' + '\n\t\t\t\t' +
                        'session.inactivityTimeout = setTimeout(function () {' + '\n\t\t\t\t\t' +
                        'console.log("Session ended due to inactivity");' + '\n\t\t\t\t\t' +
                        'SurflySession.end();' + '\n\t\t\t\t\t' +
                        '}, 600000);' : '';
                    requirementsText = "";
                    break;
                default:
                    console.log('Unknown toggle name');
                    return;
            }

            // Update eventConfigRequirements
            if (isChecked) {
                if (eventConfigRequirements) {
                    if (requirementsText) {
                        eventConfigRequirements += '\n\n' + requirementsText;
                    }
                } else {
                    if (requirementsText) {
                        eventConfigRequirements = requirementsText;
                    }
                }
            } else {
                eventConfigRequirements = eventConfigRequirements.replace(requirementsText, '').trim();
                eventConfigRequirements = eventConfigRequirements.replace(/(\n\s*\n)/g, '\n\n');
            }
            updateScriptElement();
        }
        //function to update requirements string from selections outside event actions
        function updateNonEventRequirements() {
            let newTabRequirementsText = "<span class=config-category>open extra tabs:</span>" + "&nbsp;new_urls_allowed";
            if (AdditionalUrls) {
                if (eventConfigRequirements && !firstTabUrlSubmitted) {
                    eventConfigRequirements += '\n\n' + newTabRequirementsText;
                }
                else {
                    eventConfigRequirements = newTabRequirementsText;
                    firstTabUrlSubmitted = true;
                }
            }
            else {
                eventConfigRequirements = eventConfigRequirements.replace(newTabRequirementsText, '').trim();
                eventConfigRequirements = eventConfigRequirements.replace(/(\n\s*\n)/g, '\n\n');
                firstTabUrlSubmitted = false;
            }
            updateScriptElement();
        }

        //function to update the video view preferences
        function toggleVideoView(selectElement) {
            const selectedValue = selectElement.value;
            const id = selectElement.id;
            settings[id] = selectedValue;
            console.log(`Selected video view mode for ${id}:`, selectedValue);
            updateScriptElement(); // Update the script element when the video view mode changes
        }


        // Function to toggle selection and update selectedRegions array
        function toggleSelect(img) {
            img.classList.toggle('selected');
            const id = img.id;
            if (img.classList.contains('selected')) {
                if (!selectedRegions.includes(id)) {
                    selectedRegions.push(id);
                }
            } else {
                const index = selectedRegions.indexOf(id);
                if (index > -1) {
                    selectedRegions.splice(index, 1);
                }
            }
            updateScriptElement(); // Update the script element when selection changes
        }

        //function to add the widget key
        function addWidgetKeyToCode() {
            const widgetKeyInput = document.getElementById('widget_key_input').value.trim();
            widgetKey = widgetKeyInput;

            //add to the session builder page settings var so we can import settings from Surfly from the key
            settings.widget_key = widgetKey;
            console.log(settings.widget_key);

            updateScriptElement(); // Update the script element when the URL changes
            document.getElementById('widget_key_input').value = '';
        }

        // Function to reset the URL and update the script element
        function resetWidgetKey() {
            widgetKey = '';
            updateScriptElement(); // Update the script element when the URL is reset
            delete settings.widget_key; //remove from Surfly settings var for the session builder page
        }

        // Function to fetch the URL from the input field and update startUrl
        function addUrlToCode() {
            const urlInput = document.getElementById('session_url_input').value.trim();

            // Regular expression to check if the URL starts with 'www.' and contains a domain like '.com', '.net', etc.
            const urlPattern = /^(https?:\/\/)?(www\.)[a-zA-Z0-9-]+\.[a-zA-Z]{2,}$/;

            if (urlPattern.test(urlInput)) {
                try {
                    const url = new URL(urlInput.includes('://') ? urlInput : `https://${urlInput}`);
                    startUrl = url.href;
                    updateScriptElement(); // Update the script element when the URL changes
                    document.getElementById('session_url_input').value = '';
                } catch (e) {
                    alert('Please enter a valid URL');
                }
            } else {
                alert('Please enter a valid URL that starts with "www" and includes a valid domain.');
            }
        }

        // Function to reset the URL and update the script element
        function resetUrl() {
            startUrl = '';
            updateScriptElement(); // Update the script element when the URL is reset
        }

        //function to build the masking string
        function addToSelectors() {
            const inputElement = document.getElementById('masking_input');
            const inputValue = inputElement.value.trim();

            if (inputValue) {
                if (maskingString) {
                    maskingString += ',' + inputValue;
                } else {
                    maskingString = inputValue;
                }
                console.log('Updated maskingString:', maskingString);
            }

            inputElement.value = '';
            updateScriptElement(); // Update the script element to reflect changes
        }

        //clear the masking selectors
        function clearMaskingString() {
            maskingString = '';
            console.log('Masking string cleared:', maskingString);
            updateScriptElement();
        }

        //function to build the additional tab string
        function addToAdditionalTabs() {
            const urlPattern = /^(https?:\/\/)?(www\.)[a-zA-Z0-9-]+\.[a-zA-Z]{2,}$/;
            const inputUrlString = document.getElementById('additional_tab_input');
            const inputUrlValue = inputUrlString.value.trim();
            if (urlPattern.test(inputUrlValue)) {
                if (inputUrlValue) {
                    if (AdditionalUrls) {
                        AdditionalUrls += ', ' + inputUrlValue;
                        AdditionalUrlNewTabs = AdditionalUrlNewTabs + '\n\t\t\t\t' + 'SurflySession.openTab("' + 'https://' + inputUrlValue + '");';
                        AdditionalUrlQueryParams += '&url=' + inputUrlValue;
                    } else {
                        AdditionalUrls = inputUrlValue;
                        AdditionalUrlNewTabs = 'SurflySession.openTab("' + 'https://' + inputUrlValue + '");';
                        AdditionalUrlQueryParams = '?url=' + inputUrlValue;
                    }
                    console.log('Updated masking String:', AdditionalUrlQueryParams);
                }
                inputUrlString.value = '';
                updateNonEventRequirements();
                updateScriptElement();
            } else {
                alert('Please enter a valid URL that starts with "www" and includes a valid domain.');
            }
        }

        //clear additional tab string
        function clearAdditionalTabs() {
            AdditionalUrls = '';
            AdditionalUrlNewTabs = '';
            AdditionalUrlQueryParams = '';
            console.log('AdditionalUrlQueryParams string cleared:', AdditionalUrlQueryParams);
            updateNonEventRequirements();
            updateScriptElement();
        }

        //function to build the tags string
        function addToTags() {
            const inputTag = document.getElementById('tags_input').value.trim();
            if (inputTag) {
                if (!tagsArray) {
                    tagsArray = [];
                }
                tagsArray.push(inputTag);
                indentedTagsArray = "[\n" +
                    tagsArray.map((tag, index) => {
                        const comma = index < tagsArray.length - 1 ? ',' : '';
                        return `\t\t"${tag}"${comma}`;
                    }).join('\n') + ',' + '\n\t\t"Session-Builder"' +
                    "\n\t\t\t]";

                document.getElementById('tags_input').value = '';
                updateScriptElement();
            }
        }
        //clear the tag string
        function clearTags() {
            tagsArray = '';
            indentedTagsArray = '';
            console.log('tagsArray cleared:', tagsArray);
            updateScriptElement();
        }

        //function to build the metadata string
        function addToMetadata() {
            const inputMetadataKey = document.getElementById('metadata_input_key').value.trim();
            const inputMetadataValue = document.getElementById('metadata_input_value').value.trim();

            if (inputMetadataKey && inputMetadataValue) {
                // Add or update the key-value pair in the object
                metadataObject[inputMetadataKey] = inputMetadataValue;
                formattedMetadataJSON = JSON.stringify(metadataObject, null, 2);
                formattedMetadataJSON = formattedMetadataJSON.replace(/},\s*{/g, '},\n{');
                indentedFormattedMetadataJSON = formattedMetadataJSON.split('\n').map(line => `\t\t\t\t\t\t${line}`).join('\n');

                indentedFormattedMetadataJSON.isChecked;
                console.log('Updated Metadata object:', metadataObject);
            }

            // Clear the input fields
            document.getElementById('metadata_input_key').value = '';
            document.getElementById('metadata_input_value').value = '';
            updateScriptElement();
        }

        //clear metadata string
        function clearMetadata() {
            metadataObject = {};
            formattedMetadataJSON = '';
            indentedFormattedMetadataJSON = '';
            indentedFormattedMetadataJSON.isChecked = false;
            console.log('Metadata object cleared:', metadataObject);
            updateScriptElement();
        }
    </script>

    <script>
        //6// MAKE SURE IT WORKS
        //Manage settings combinations and ensure nothing weird can happen

        //function to change the available options based in initial selections


            function updateAvailableOptions() {
                const inputs = document.querySelectorAll('.settings-toggle input');
                const VideoOptions = document.getElementById("video-toggles");
                const VideoHeading = document.getElementById("video-heading");
                const DocumentEditorOptions = document.getElementById("document-editor-toggles");
                const DocumentEditorHeading = document.getElementById("document-editor-heading");

                inputs.forEach(input => {
                    const id = input.parentElement.id;
                    const isChecked = input.checked;

                    // Hide/show video options based on videochat_enabled
                    if (id === "videochat_enabled" && isChecked) {
                        console.log("Enable the video options");
                        VideoOptions.style.display = "";
                        VideoHeading.innerHTML = "Video";
                    } else if (id === "videochat_enabled" && !isChecked) {
                        console.log("Disable the video options");
                        VideoOptions.style.display = "none";
                        VideoHeading.innerHTML = "Video<span style='color:var(--grey);font-weight:lighter;opacity:60%;'>(requires videochat_enabled)</span>";
                    }

                    // Hide/show document editor options based on document_editor_enabled
                    if (id === "document_editor_enabled" && isChecked) {
                        console.log("Enable the document editor options");
                        DocumentEditorOptions.style.display = "";
                        DocumentEditorHeading.innerHTML = "Document Editor";
                    } else if (id === "document_editor_enabled" && !isChecked) {
                        console.log("Disable the document editor options");
                        DocumentEditorOptions.style.display = "none";
                        DocumentEditorHeading.innerHTML = "Document Editor<span style='color:var(--grey);font-weight:lighter;opacity:60%;'>(requires document_editor_enabled)</span>";
                    }
                });
                updateScriptElement();
            }

            document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.settings-toggle input').forEach(input => {
                input.addEventListener('change', updateAvailableOptions);
            });
            updateAvailableOptions();
        });


    </script>

    <script>
        //7// LISTNERS
        //mapping elements to functions

        document.addEventListener('DOMContentLoaded', () => {
            //skip queue toggle
            document.getElementById('skip_queue').addEventListener('change', function () {
                if (this.checked) {
                    skipQueue = '"skip_queue": true';
                } else {
                    skipQueue = '';
                }
                updateScriptElement();
            });
            // Event listener for settings toggles
            document.querySelectorAll('.settings-toggle input').forEach(input => {
                input.addEventListener('change', (event) => {
                    const id = event.target.parentElement.id; // Get the id from the parent element
                    const isChecked = event.target.checked; // Get the state of the checkbox

                    // Update the settings object with the new value
                    settings[id] = isChecked;

                    console.log(`Setting ${id} is ${isChecked ? 'enabled' : 'disabled'}`);
                    updateScriptElement(); // Update the script element when settings change
                });
            });

            // Event listener for the "Add to code" button for widget key
            document.getElementById('add-widget-key-button').addEventListener('click', addWidgetKeyToCode);
            // Event listener for the "Reset" button
            document.getElementById('reset-widget-key-button').addEventListener('click', resetWidgetKey);

            // Event listener for the "Add to code" button for url
            document.getElementById('add-url-button').addEventListener('click', addUrlToCode);
            // Event listener for the "Reset" button
            document.getElementById('reset-url-button').addEventListener('click', resetUrl);

            // Event listener for the "Add to selectors" button
            document.getElementById('add_masking_selector_button').addEventListener('click', addToSelectors);
            // Event listener for the "Reset" button
            document.getElementById('clear_masking_selectors').addEventListener('click', clearMaskingString);

            // Event listener for the "Add to selectors" button
            document.getElementById('add_additional_tabs_button').addEventListener('click', addToAdditionalTabs);
            // Event listener for the "Reset" button
            document.getElementById('clear_additional_tabs_button').addEventListener('click', clearAdditionalTabs);

            // Event listener for adding tags button
            document.getElementById('add_tags_button').addEventListener('click', addToTags);
            // Event listener for the "Reset" button
            document.getElementById('clear_tags_button').addEventListener('click', clearTags);

            // Event listener for adding metadata button
            document.getElementById('add_metadata_button').addEventListener('click', addToMetadata);
            // Event listener for the "Reset" button
            document.getElementById('clear_metadata_button').addEventListener('click', clearMetadata);

            //toggle JS preview modal view
            document.getElementById('hide-show-button').addEventListener('click', toggleJavascriptPreview);

            //Event listners for event adding section
            document.getElementById('start-screenshare').addEventListener('change', function () {
                updateEventVariables('instantScreenShare', this.checked);
            });

            document.getElementById('host-and-control-transfer').addEventListener('change', function () {
                updateEventVariables('controlAndHostToAgent', this.checked);
            });

            document.getElementById('full-screen-video-on-start').addEventListener('change', function () {
                updateEventVariables('startFullScreenVideo', this.checked);
            });

            document.getElementById('end-if-no-agent').addEventListener('change', function () {
                updateEventVariables('endIfNoAgent', this.checked);
            });

            document.getElementById('end-if-no-activity').addEventListener('change', function () {
                updateEventVariables('endIfNoActivity10Mins', this.checked);
            });

            //listen for click to import settings from widget key
            document.getElementById('add-widget-key-button').addEventListener('click', importSurflySetttings);
            //listen for click to reset anything imported from a widget key
            document.getElementById('reset-widget-key-button').addEventListener('click', removeImportedSurflySetttings);

        });

        // Initial update of the script element
        document.addEventListener('DOMContentLoaded', () => {
            updateScriptElement();
        });




    </script>
    <script id="realSurflyScript">
        //8// USING THE GENERATED SNIPPET

        //Turn text content of code snippet element into usable function & manage its use on the page
        function startSessionHere() {
            const surflySnippet = scriptElement.textContent;
            const startSurfly = new Function(surflySnippet);
            const refreshPageMessage = document.getElementById("refresh-page-message")
            if (!widgetKey) {
                alert('Your need a widget key to start a session!');
            }
            else {
                refreshPageMessage.classList.remove('warning-message-hidden');
                refreshPageMessage.classList.add('warning-message');
                startSurfly();
            }
        }

        //copy code snippet to clipboard for use elsewhere
        function copyCode() {
            const surflySnippet = scriptElement.textContent;
            if (!widgetKey) {
                alert('Your need a widget key to start a session!');
            }
            else {
                navigator.clipboard.writeText(surflySnippet).then(() => alert('The Surfly code snippet has been copied to the clipboard.'));
            }
        }

        function copyCodeWithButton() {
            const surflySnippet = scriptElement.textContent;
            const buttonCode = `
const customSurflyButton = document.createElement('button');
customSurflyButton.style.position = 'fixed';
customSurflyButton.style.bottom = '20px';
customSurflyButton.style.right = '20px';
customSurflyButton.style.zIndex = '1000';
customSurflyButton.style.backgroundColor = 'white';
customSurflyButton.style.border = '2px solid #c72323';
customSurflyButton.style.borderRadius = '50%';
customSurflyButton.style.width = '60px';
customSurflyButton.style.height = '60px';
customSurflyButton.style.display = 'flex';
customSurflyButton.style.justifyContent = 'center';
customSurflyButton.style.alignItems = 'center';
customSurflyButton.style.cursor = 'pointer';
customSurflyButton.style.boxShadow = '0 4px 8px rgba(0, 0, 0, 0.2)';
customSurflyButton.style.padding = '0';
customSurflyButton.style.overflow = 'hidden';

const iconImage = document.createElement('img');
iconImage.src = 'https://github.com/JSPOON3R/JSPOON3R.github.io/blob/main/resources-common/icons/tools.png?raw=true';
iconImage.style.width = '60%';
iconImage.style.height = '60%';
iconImage.style.objectFit = 'contain';

customSurflyButton.appendChild(iconImage);

customSurflyButton.addEventListener('click', () => {
   ${surflySnippet}
});
document.body.appendChild(customSurflyButton);
            `
            if (!widgetKey) {
                alert('Your need a widget key to start a session!');
            }
            else {
                navigator.clipboard.writeText(buttonCode).then(() => alert('The custom button code snippet has been copied to the clipboard.'));
            }
        }
    </script>


</head>

<body>
    <div class="warning-message-hidden" id="refresh-page-message">
        <p class="warning-message-text">
            <svg xmlns="http://www.w3.org/2000/svg" width="15px" height="15px" viewBox="0 0 24 24"
                style="vertical-align: middle;">
                <path fill="white"
                    d="M12 5.177l8.631 15.823h-17.262l8.631-15.823zm0-4.177l-12 22h24l-12-22zm-1 9h2v6h-2v-6zm1 9.75c-.689 0-1.25-.56-1.25-1.25s.561-1.25 1.25-1.25 1.25.56 1.25 1.25-.561 1.25-1.25 1.25z" />
            </svg>&nbsp;&nbsp;Refresh the page to start again&nbsp;&nbsp;
        </p>
    </div>
    <div class="content" id="session-builder-ui">
        <div class="hide-show-js-div">
            <button id="hide-show-button">
                <svg id="expand-collapse-arrow" xmlns="http://www.w3.org/2000/svg" width="22px" height="22px">
                    <path
                        d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8.009 8.009 0 0 1-8 8z"
                        fill="var(--grey)" />
                    <path
                        d="M11.293 8.707 13.586 11H8v2h5.586l-2.293 2.293 1.414 1.414L17.414 12l-4.707-4.707-1.414 1.414z"
                        fill="var(--grey)" />
                </svg>
            </button>
        </div>
        <div class="settings" id="settings-div">
            <div class="category">
                <h2 class="section-heading">Add your widget key</h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description">The <a
                            href="https://docs.surfly.com/tutorials/advanced-integration/#restrict-session-creation"
                            target="_blank">widget key</a> is different to the API key - <a
                            href="mailto:sales@surfly.com">contact us</a> if you don't have one</p>
                    <div class="input-string-div">
                        <input type="text" placeholder="Enter your Widget Key" class="input-field" id="widget_key_input"
                            value="">
                        <button id="add-widget-key-button">Add to code</button>
                        <button id="reset-widget-key-button">Reset</button>
                    </div>
                </div>
                <span id="widget-key-preview" class="input-preview"></span>
            </div>
            <div class="category">
                <h2 class="section-heading">Session queue</h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description">Should the session appear in the <a
                            href="https://app.surfly.com/incoming_queue/" target="_blank">incoming queue</a>?</p>
                    <div class="single-toggle" id="queue-toggle">
                        <label class="switch">
                            <input type="checkbox" id="skip_queue">
                            <span class="slider"></span>
                        </label>
                        <h2>skip_queue</h2>
                    </div>
                </div>
            </div>
            <div class="category">
                <h2 class="section-heading">Starting website/webapp</h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description">Leave empty to use the page the session will start from.</p>
                    <div class="input-string-div">
                        <input type="text" placeholder="e.g. www.wikipedia.com" class="input-field"
                            id="session_url_input" value="">
                        <button id="add-url-button">Add to code</button>
                        <button id="reset-url-button">Reset</button>
                    </div>
                </div>
                <span id="start-url-preview" class="input-preview"></span>
            </div>
            <div class="category">
                <h2 class="section-heading">Select server region(s)</h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description">Pin traffic to a single <a
                            href="https://help.surfly.com/en/what-are-the-surfly-ip-addresses" target="_blank">server
                            region</a> or select multiple</p>
                    <div class="category-items">
                        <img src="https://raw.githubusercontent.com/JSPOON3R/JSPOON3R.github.io/main/resources-common/icons/usa-icon.png"
                            alt="USA" id="us-west" onclick="toggleSelect(this)">
                        <img src="https://raw.githubusercontent.com/JSPOON3R/JSPOON3R.github.io/main/resources-common/icons/canada-icon.png"
                            alt="CA" id="ca-east" onclick="toggleSelect(this)">
                        <img src="https://raw.githubusercontent.com/JSPOON3R/JSPOON3R.github.io/main/resources-common/icons/germany-icon.png"
                            alt="DE" id="eu-de" onclick="toggleSelect(this)">
                        <img src="https://raw.githubusercontent.com/JSPOON3R/JSPOON3R.github.io/main/resources-common/icons/nl-icon.png"
                            alt="NL" id="eu-nl" onclick="toggleSelect(this)">
                        <img src="https://raw.githubusercontent.com/JSPOON3R/JSPOON3R.github.io/main/resources-common/icons/uk-icon.png"
                            alt="UK" id="eu-uk" onclick="toggleSelect(this)">
                        <img src="https://github.com/JSPOON3R/JSPOON3R.github.io/blob/main/resources-common/icons/hongkong-48.png?raw=true"
                            alt="HK" id="asia-hk" onclick="toggleSelect(this)">
                        <img src="https://raw.githubusercontent.com/JSPOON3R/JSPOON3R.github.io/main/resources-common/icons/india-icon.png"
                            alt="IN" id="india" onclick="toggleSelect(this)">
                        <img src="https://raw.githubusercontent.com/JSPOON3R/JSPOON3R.github.io/main/resources-common/icons/aus-icon.png"
                            alt="AUS" id="au" onclick="toggleSelect(this)">
                    </div>
                </div>
            </div>
            <div class="category">
                <h2 class="section-heading">Configure the session </h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description">Overview of all <a href="https://docs.surfly.com/session-options"
                            target="_blank">session options</a> and what they do.<br><i
                            style="color:var(--grey);font-size:.7rem;">Settings not selected here will use the value
                            given in your
                            Surfly environment - toggle to override</i></p>
                    <h2 class="category-heading">Features</h2>
                    <div class="feature-toggles">
                        <div class="settings-toggle">
                            <label class="switch" id="videochat_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>videochat_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="document_editor_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>document_editor_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="chat_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>chat_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="screensharing_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>screensharing_enabled</h2>
                        </div>
                    </div>
                    <h2 class="category-heading" id="video-heading">Video
                    </h2>
                    <div class="feature-toggles" id="video-toggles">
                        <div class="settings-toggle">
                            <label class="switch" id="start_with_videochat_on">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>start_with_videochat_on</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="start_with_fullscreen_videochat">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>start_with_fullscreen_videochat</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="videochat_prompt">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>videochat_prompt</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="anonymous_users_can_share_camera">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>anonymous_users_can_share_camera</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="p2p_videochat_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>p2p_videochat_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="start_muted">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>start_muted</h2>
                        </div>
                        <div class="settings-toggle">
                            <div class="view-select">
                                <select class="drop-down" id="default_videochat_fullscreen_mode"
                                    onchange="toggleVideoView(this)">
                                    <option value="grid">grid</option>
                                    <option value="spotlight">spotlight</option>
                                </select>
                                <h2>default_videochat_fullscreen_mode</h2>
                            </div>
                        </div>
                        <div class="settings-toggle">
                            <div class="view-select">
                                <select class="drop-down" id="default_videochat_mode" onchange="toggleVideoView(this)">
                                    <option value="floating">floating</option>
                                    <option value="sidebar">sidebar</option>
                                </select>
                                <h2>default_videochat_mode</h2>
                            </div>
                        </div>
                    </div>
                    <h2 class="category-heading" id="document-editor-heading">Documents & Files</h2>
                    <div class="feature-toggles" id="document-editor-toggles">
                        <div class="settings-toggle">
                            <label class="switch" id="download_trigger_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>download_trigger_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="filesharing_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>filesharing_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="original_file_download_allowed">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>original_file_download_allowed</h2>
                        </div>
                    </div>
                    <h2 class="category-heading">Permissions & Control</h2>
                    <div class="feature-toggles">
                        <div class="settings-toggle">
                            <label class="switch" id="admission_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>admission_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="anyone_can_deactivate_space">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>anyone_can_deactivate_space</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="block_until_agent_joins">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>block_until_agent_joins</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="default_invitations_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>default_invitations_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="host_switching_allowed">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>host_switching_allowed</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="invitations_allowed">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>invitations_allowed</h2>
                        </div>

                        <div class="settings-toggle">
                            <label class="switch" id="new_urls_allowed">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>new_urls_allowed</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="participants_can_request_to_interact">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>participants_can_request_to_interact</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="non_hosts_can_open_tabs">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>non_hosts_can_open_tabs</h2>
                        </div>
                    </div>
                    <h2 class="category-heading">Appearance & Experience</h2>
                    <div class="feature-toggles">
                        <div class="settings-toggle">
                            <label class="switch" id="notifications_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>notifications_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="sounds_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>sounds_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="end_redirect_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>end_redirect_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="hide_cursors">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>hide_cursors</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="headless">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>headless</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="hide_session_ui">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>hide_session_ui</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="private_session">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>private_session</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="start_with_loading_screen">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>start_with_loading_screen</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="multileader">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>multileader</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="session_start_confirmation">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>session_start_confirmation</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="session_autorestore_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>session_autorestore_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="start_with_invite_modal">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>start_with_invite_modal</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="pause_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>pause_enabled</h2>
                        </div>

                        <div class="settings-toggle">
                            <label class="switch" id="start_with_chat_open">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>start_with_chat_open</h2>
                        </div>
                    </div>
                    <h2 class="category-heading">Browsing & Security</h2>
                    <div class="feature-toggles">
                        <div class="settings-toggle">
                            <label class="switch" id="cookie_transfer_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>cookie_transfer_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="format_session_id">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>format_session_id</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="url_mangling">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>url_mangling</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="alternative_proxy_enabled">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>alternative_proxy_enabled</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="enable_cookie_backtransfer">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>enable_cookie_backtransfer</h2>
                        </div>
                        <div class="settings-toggle">
                            <label class="switch" id="native_selects">
                                <input type="checkbox">
                                <span class="slider"></span>
                            </label>
                            <h2>native_selects</h2>
                        </div>
                    </div>
                </div>
            </div>
            <div class="category">
                <h2 class="section-heading">Add element masking</h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description">Element Masking <a
                            href="https://www.youtube.com/watch?v=4oDZKSgJM_g" target="_blank">tutorial</a></p>
                    <div class="input-string-div">
                        <input type="text" placeholder="Enter the CSS selector of the element you want to mask"
                            class="input-field" id="masking_input">
                        <button id="add_masking_selector_button">Add to Selectors</button>
                        <button id="clear_masking_selectors">Clear</button>
                    </div>
                    <span id="masking-preview" class="input-preview"></span>
                </div>
            </div>
            <div class="category">
                <h2 class="section-heading">Add additional tabs</h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description">Additional tabs will open automatically once the session begins</a>
                    </p>
                    <div class="input-string-div">
                        <input type="text" placeholder="e.g. www.google.com" class="input-field"
                            id="additional_tab_input">
                        <button id="add_additional_tabs_button">Add to code</button>
                        <button id="clear_additional_tabs_button">Reset</button>
                    </div>
                    <span id="additional-tab-preview" class="input-preview"></span>
                    <p id="additional-tab-preview-query-paramaters" class="category-description"></p>
                </div>
            </div>
            <div class="category">
                <h2 class="section-heading">Add your own data</h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description" id="tags-description">Tags will appear in the session record and in
                        <a href="https://docs.surfly.com/webhooks" target="_blank">webhooks</a></a>
                    </p>
                    <div class="input-string-div">
                        <input type="text" placeholder="e.g. customer name, customer query, etc" class="input-field"
                            id="tags_input">
                        <button id="add_tags_button">Add to Code</button>
                        <button id="clear_tags_button">Reset</button>
                    </div>
                    <span id="tags-preview" class="input-preview"></span>
                    <p class="category-description" id="metadata-description">Metadata will appear in the session queue
                        and in <a href="https://docs.surfly.com/webhooks" target="_blank">webhooks</a></a>
                    </p>
                    <div class="input-string-div">
                        <input type="text" placeholder="Key" class="input-field" id="metadata_input_key">
                        <input type="text" placeholder="Value" class="input-field" id="metadata_input_value">
                        <button id="add_metadata_button">Add to Code</button>
                        <button id="clear_metadata_button">Reset</button>
                    </div>
                    <span id="metadata-preview" class="input-preview"></span>
                </div>
            </div>
            <div class="category">
                <h2 class="section-heading">Add automated event actions</h2>
                <button class="toggle-button" onclick="toggleCategory(this)">Expand</button>
                <div class="category-content" style="display: none;">
                    <p class="category-description">See more Surfly <a
                            href="https://docs.surfly.com/javascript-api/surfly-events" target="_blank">Javascript
                            Events</a></p>
                    <label class="checkbox-option">
                        <input type="checkbox" id="end-if-no-agent">
                        <span class="custom-checkbox"></span>
                        End session if nobody else joins in 2 minutes
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="end-if-no-activity">
                        <span class="custom-checkbox"></span>
                        End session after 10 minutes of inactivity
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="start-screenshare">
                        <span class="custom-checkbox"></span>
                        Automatically start traditional screen share
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="host-and-control-transfer">
                        <span class="custom-checkbox"></span>
                        Transfer Host and Control to agent when they join
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="full-screen-video-on-start">
                        <span class="custom-checkbox"></span>
                        Make video full screen when someone joins
                    </label>
                </div>
            </div>
            <div class="required-configs-div" id="required-configs">
                <span id="config-requirements-heading">your session requires the following options selected:</span>
                <span id="event-config-requirements-preview"></span>
            </div>
        </div>
        <div class="button-container">
            <div class="copy-buttons">
                <button class="start-session" id="copy-session-code" onclick="startSessionHere()">Start Session
                    Here</button>
            </div>
            <span class="or"></span>
            <button class="start-session" id="start-session-on-page" onclick="copyCode()">Copy
                Snippet</button>
            <button class="start-session" id="start-session-on-page" onclick="copyCodeWithButton()">Copy Custom Button
                Snippet</button>
        </div>
        <div class="disclaimer">
            <div class="disclaimer-title">Disclaimer: this page has been designed to assist only</div>
            <div class="disclaimer-text">The code generated by this tool is provided solely as a guide for informational
                purposes. Surfly makes no guarantees, warranties, or representations, express or implied, as to the
                accuracy, reliability, or completeness of the code generated. Any code used or implemented in your
                production environment is at your own risk. Surfly shall not be held liable for any direct, indirect,
                incidental, special, consequential, or exemplary damages, including but not limited to system
                malfunctions, data loss, security vulnerabilities, or operational failures, arising from the use of the
                generated code. We strongly recommend reviewing and testing the code in a development environment before
                deploying it in production. By using this tool, you acknowledge and agree that Surfly is not responsible
                for any claims, losses, damages, or liabilities that may result from the use of the generated code.
            </div>
        </div>
    </div>
    <div class="javascript-window" id="javascript-viewer">
        <pre><code id="code-preview" class="language-javascript">
        </code></pre>
    </div>
</body>

</html>