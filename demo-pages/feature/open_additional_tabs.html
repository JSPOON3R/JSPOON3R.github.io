<!DOCTYPE html>
<html lang="en">
<link rel="shortcut icon" type="image/x-icon" href="https://demo.surfly.com/resources-common/icons/Favicon-PNG.png">
<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://demo.surfly.com/css-common/surfly-javascript-style.css" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-javascript.min.js"></script>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Modal Example</title>
    <style>
        :root {
            --light-red: #e54747;
            --dark-red: #c72323;
            --light-blue: #7cadbf;
            --blue: #2288ad;
            --dark-blue: #166e8e;
            --yellow: #f4c344;
            --orange: #fd942a;
            --light-green: #7dc05a;
            --dark-green: #48a418;
            --darkest-grey: #4d4d4d;
            --dark-grey: #757575;
            --grey: #b2b2b2;
            --light-grey: #d8dada;
            --lightest-gray: #eff0f0;
            --white: #ffffff;
            --background: #2f2f2f;
            --font: 'Nunito', sans-serif;

        }

        body {
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: flex-start;
            background-color: var(--white);
            font-family: var(--font);
            overflow: hidden;
        }

        .content {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 40%;
            height: 100%;
            padding: 20px;
        }

        .content-body {
            display: flex;
            flex-direction: column;
            height: 100%;
            margin-top: 10%;
            padding: 5px;
        }

        .javascript-window {
            font-size: .7em;
            width: 60%;
            padding: 20px;
            overflow: auto;
            height: 100vh;
            background-color: var(--background-dark);
            border-left: 1px solid #ddd;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0, 0, 0, 0.4);
        }

        .modal-content {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 15% auto;
            padding: 20px;
            width: 80%;
            max-width: 500px;
            text-align: center;
            background-color: var(--light-blue);
            border-radius: 8px;
            border: 2px solid var(--light-grey);
        }

        .modal button {
            margin: 5px;
        }

        .submit-button {
            background-color: var(--dark-red);
            box-sizing: border-box;
            border-radius: 50px;
            color: var(--white);
            cursor: pointer;
            font-family: var(--font);
            font-size: 1rem;
            font-weight: 100;
            padding: .5rem .8rem;
            border: 0;
            touch-action: manipulation;
            white-space: nowrap;
            width: 60%;
        }

        .input-field {
            width: 90%;
            padding: 10px;
            font-size: 1rem;
            border: 2px solid var(--blue);
            border-radius: 50px;
            margin-bottom: 5px;
            outline: none;
        }

        .input-field:focus {
            border-color: var(--dark-blue);
        }

        .surfly-logo {
            width: 10%;
        }

        h2 {
            color: var(--darkest-grey);
            font-size: 2em;
        }

        li {
            color: var(--dark-grey);
            font-size: 1.5em;
        }

        p,
        label {
            color: var(--white);
            font-size: 1em;
        }

        .button-description {
            color: var(--lightest-gray);
            font-size: .8em;
            margin: 0;
            padding: 0;
        }
    </style>
</head>

<body>
    <div class="content">
        <img class="surfly-logo"
            src="https://raw.githubusercontent.com/JSPOON3R/JSPOON3R.github.io/64e869e4cd0a5d200c10c0e9bfd00adba7e4e60c/resources-common/images/Surfly_Logo.png"
            alt="Logo">
        <div class="content-body">
            <h2><b>This Page:</b></h2>
            <li>This page demonstrates one way to tstart a Surfly session with multiple tabs from the begininng without needing users to manually open them</li><br>
            <li><b>Important:</bb> the person who opens a tab will be in control of that tab & will be able to see any masked elements</li><br>
            <li>This page shows both opening the tabs for yourself and instructing Surfly to open them for another participant</li>
            <br>
            <br>
            <button id="openModalBtn" class="submit-button">Click Here to Test</button>

            <div id="myModal" class="modal">
                <div class="modal-content">
                    <p>Enter your additional URLs here. Ensure they are formatted correctly and are each seperated by a
                        comma</p>
                    <input type="text" id="manualInput" name="manualInput" placeholder="www.bing.com,www.wikipedia.com"
                        class="input-field">
                    <button id="startBtn" class="submit-button">Start Session & open tabs<p class="button-description">
                            <i>tabs will open for you</i>
                        </p></button>
                    <button id="startBtn2" class="submit-button">Start Session & Copy link <p
                            class="button-description"><i>tabs will open for the other participant</i></p>
                    </button>

                    <button id="cancelBtn" class="submit-button">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <div class="javascript-window">
        <pre><code id="code-preview" class="language-javascript">
Javascript goes here
        </code></pre>
    </div>

    <script id="myScript">

        var SurflySession;
        //added manual_input variable to store the pop up input collected and pass it to the Surfly API
        var manual_input;

        //JS to manage the pop up display
        document.addEventListener("DOMContentLoaded", function () {
            var modal = document.getElementById("myModal");
            var btn = document.getElementById("openModalBtn");
            var cancelBtn = document.getElementById("cancelBtn");
            var startBtn = document.getElementById("startBtn");
            var startBtn2 = document.getElementById("startBtn2");
            var input = document.getElementById("manualInput");

            btn.onclick = function () {
                modal.style.display = "block";
            }
            cancelBtn.onclick = function () {
                modal.style.display = "none";
            }
            window.onclick = function (event) {
                if (event.target == modal) {
                    modal.style.display = "none";
                }
            }
            startBtn.onclick = function () {
                if (input && input.value.trim() !== "") {
                    manual_input = input.value;
                }
                else {
                    manual_input = "";
                }
                loadSession();
            }
            startBtn2.onclick = function () {
                if (input && input.value.trim() !== "") {
                    manual_input = input.value;
                }
                else {
                    manual_input = "";
                }
                loadSession2();
            }
        });


        function loadSession() {
            //This function will open the new tabs on the page 
            (function (s, u, r, f, l, y) {
                s[f] = s[f] || { init: function () { s[f].q = arguments } };
                l = u.createElement(r); y = u.getElementsByTagName(r)[0]; l.async = 1;
                l.src = 'https://surfly.com/surfly.js'; y.parentNode.insertBefore(l, y);
            })
                (window, document, 'script', 'Surfly');

            //any settings specified here will override the global Surfly settings you have
            var settings = {
                widget_key: "99671227762b43c2a96daa066ee006e2",
                hide_until_agent_joins: false,
                block_until_agent_joins: false,
                start_with_invite_modal: true,
                admission_enabled: false,
                start_with_loading_screen: false,
                hide_session_ui: false,
                start_with_chat_open: false,
                url: "https://www.google.com",
                session_autorestore_enabled: false,
                videochat_enabled: true,
                start_with_invite_modal: false
            };

            Surfly.init(settings, function (init) {
                if (init.success && !Surfly.isInsideSession) {
                    console.log("init success");
                    Surfly.session().create().on("session_created", function (session, event) {
                        console.log("Leader Link: ", session.leaderLink);
                        console.log("Follower Link: ", session.followerLink);
                        //Open session in a new window with additional tabs
                        window.location.href = session.leaderLink + "?url=" + manual_input;
                    });
                }
            });
        }

        function loadSession2() {
            //This function will open a session without additional tabs. The tabs will be added to the join link and will open when it is clocked with that participant as the owner
            (function (s, u, r, f, l, y) {
                s[f] = s[f] || { init: function () { s[f].q = arguments } };
                l = u.createElement(r); y = u.getElementsByTagName(r)[0]; l.async = 1;
                l.src = 'https://surfly.com/surfly.js'; y.parentNode.insertBefore(l, y);
            })
                (window, document, 'script', 'Surfly');

            //any settings specified here will override the global Surfly settings you have
            var settings = {
                widget_key: "99671227762b43c2a96daa066ee006e2",
                hide_until_agent_joins: false,
                block_until_agent_joins: false,
                start_with_invite_modal: true,
                admission_enabled: false,
                start_with_loading_screen: false,
                hide_session_ui: false,
                start_with_chat_open: false,
                url: "https://www.google.com",
                session_autorestore_enabled: false,
                videochat_enabled: true,
                start_with_invite_modal: false
            };

            Surfly.init(settings, function (init) {
                if (init.success && !Surfly.isInsideSession) {
                    console.log("init success");
                    Surfly.session().create().on("session_created", function (session, event) {
                        console.log("Leader Link: ", session.leaderLink);
                        console.log("Follower Link: ", session.followerLink);
                        //Open session in a new window with additional tabs
                        window.open(session.leaderLink);
                        window.open(session.leaderLink+ "?url=" + manual_input, "_blank");

                        navigator.clipboard.writeText(session.followerLink+ "?url=" + manual_input, "_blank")
                    .then(() => {
                        alert("link copied to clipboard: "+session.followerLink+ "?url=" + manual_input);
                        console.log('Link copied to clipboard:', session.followerLink+ "?url=" + manual_input);
                    })
                    .catch(err => {
                        console.error('Failed to copy output to clipboard:', err);
                    });




                    });
                }
            });
        }

    </script>
    <script>
        var scriptContent = document.getElementById("myScript").textContent;

        function loadScripts() {
            const prismScript1 = document.createElement('script');
            prismScript1.src = "https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/prism.min.js";
            prismScript1.onload = function () {
                const prismScript2 = document.createElement('script');
                prismScript2.src = "https://cdnjs.cloudflare.com/ajax/libs/prism/1.24.1/components/prism-javascript.min.js";
                document.body.appendChild(prismScript2);
            };
            document.body.appendChild(prismScript1);
        }

        document.addEventListener("DOMContentLoaded", function () {
            document.getElementById("code-preview").innerHTML = scriptContent;
            loadScripts();
        })
    </script>
</body>

</html>